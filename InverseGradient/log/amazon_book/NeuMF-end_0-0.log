arguments: Namespace(batch_size=1024, dataset='amazon_book', drop_rate=0.0, dropout=0.0, epochs=10, eval_freq=2000, exponent=1, factor_num=32, gpu='5', lr=0.001, model='NeuMF-end', num_gradual=0, num_layers=3, num_ng=1, out=True, top_k=[50, 100]) 
config model NeuMF-end
config data path ../data/amazon_book/
config model path ./models/amazon_book/
user, item num
80464 98663
data loaded! user_num:80464, item_num:98663 train_data_len:2714021 test_user_num:80349
/storage/wjwang/anaconda3/lib/python3.7/site-packages/torch/nn/_reduction.py:43: UserWarning: size_average and reduce args will be deprecated, please use reduction='none' instead.
  warnings.warn(warning.format(ret))
epoch: 0, iter: 2000, loss:0.586310625076294
################### EVAL ######################
Eval loss:398.4521179199219
epoch: 0, iter: 4000, loss:0.49498504400253296
################### EVAL ######################
Eval loss:326.5685119628906
epoch: 1, iter: 6000, loss:0.3421326279640198
################### EVAL ######################
Eval loss:275.2273254394531
epoch: 1, iter: 8000, loss:0.3371501564979553
################### EVAL ######################
Eval loss:247.6822509765625
epoch: 1, iter: 10000, loss:0.2845563292503357
################### EVAL ######################
Eval loss:229.74876403808594
epoch: 2, iter: 12000, loss:0.22526967525482178
################### EVAL ######################
Eval loss:235.40731811523438
epoch: 2, iter: 14000, loss:0.24079827964305878
################### EVAL ######################
Eval loss:229.92587280273438
epoch: 3, iter: 16000, loss:0.20852595567703247
################### EVAL ######################
Eval loss:248.49139404296875
epoch: 3, iter: 18000, loss:0.17108166217803955
################### EVAL ######################
Eval loss:251.52032470703125
epoch: 3, iter: 20000, loss:0.17731085419654846
################### EVAL ######################
Eval loss:247.76559448242188
epoch: 4, iter: 22000, loss:0.1456637978553772
################### EVAL ######################
Eval loss:296.3355407714844
epoch: 4, iter: 24000, loss:0.146150603890419
################### EVAL ######################
Eval loss:289.9726867675781
epoch: 4, iter: 26000, loss:0.17422068119049072
################### EVAL ######################
Eval loss:284.0045471191406
epoch: 5, iter: 28000, loss:0.12388910353183746
################### EVAL ######################
Eval loss:345.2342224121094
epoch: 5, iter: 30000, loss:0.12629951536655426
################### EVAL ######################
Eval loss:335.79949951171875
epoch: 6, iter: 32000, loss:0.11687183380126953
################### EVAL ######################
Eval loss:396.73931884765625
epoch: 6, iter: 34000, loss:0.10936857759952545
################### EVAL ######################
Eval loss:375.5470886230469
epoch: 6, iter: 36000, loss:0.11292744427919388
################### EVAL ######################
Eval loss:358.22491455078125
epoch: 7, iter: 38000, loss:0.10326297581195831
################### EVAL ######################
Eval loss:447.0172424316406
epoch: 7, iter: 40000, loss:0.10138224810361862
################### EVAL ######################
Eval loss:433.7968444824219
epoch: 7, iter: 42000, loss:0.10362786054611206
################### EVAL ######################
Eval loss:423.8554992675781
epoch: 8, iter: 44000, loss:0.1012515276670456
################### EVAL ######################
Eval loss:475.1198425292969
epoch: 8, iter: 46000, loss:0.08525516092777252
################### EVAL ######################
Eval loss:491.2637634277344
epoch: 9, iter: 48000, loss:0.08397869765758514
################### EVAL ######################
Eval loss:574.5047607421875
epoch: 9, iter: 50000, loss:0.08367056399583817
################### EVAL ######################
Eval loss:560.01806640625
epoch: 9, iter: 52000, loss:0.07839557528495789
################### EVAL ######################
Eval loss:529.577880859375
############################## Training End. ##############################
################### TEST ######################
Recall 0.0512-0.0829
NDCG 0.0211-0.0282
