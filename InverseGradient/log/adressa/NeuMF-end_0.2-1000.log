arguments: Namespace(batch_size=1024, dataset='adressa', drop_rate=0.2, dropout=0.0, epochs=10, eval_freq=100, exponent=1, factor_num=32, gpu='6', lr=0.001, model='NeuMF-end', num_gradual=1000, num_layers=3, num_ng=1, out=True, top_k=[3, 20]) 
config model NeuMF-end
config data path ../data/adressa/
config model path ./models/adressa/
user, item num
212231 6596
data loaded! user_num:212231, item_num:6596 train_data_len:419491 test_user_num:10380
/storage/wjwang/anaconda3/lib/python3.7/site-packages/torch/nn/_reduction.py:43: UserWarning: size_average and reduce args will be deprecated, please use reduction='none' instead.
  warnings.warn(warning.format(ret))
epoch: 0, iter: 100, loss:0.04307005554437637
################### EVAL ######################
Eval loss:53.21295928955078
epoch: 0, iter: 200, loss:0.02881002426147461
################### EVAL ######################
Eval loss:50.84550857543945
epoch: 0, iter: 300, loss:0.017035869881510735
################### EVAL ######################
Eval loss:61.08308029174805
epoch: 0, iter: 400, loss:0.037840038537979126
################### EVAL ######################
Eval loss:91.81222534179688
epoch: 0, iter: 500, loss:0.014535123482346535
################### EVAL ######################
Eval loss:98.21186828613281
epoch: 0, iter: 600, loss:0.03724558651447296
################### EVAL ######################
Eval loss:102.38894653320312
epoch: 0, iter: 700, loss:0.007319859694689512
################### EVAL ######################
Eval loss:89.03919219970703
epoch: 0, iter: 800, loss:0.021610600873827934
################### EVAL ######################
Eval loss:89.73111724853516
epoch: 1, iter: 900, loss:0.022554131224751472
################### EVAL ######################
Eval loss:88.89420318603516
epoch: 1, iter: 1000, loss:0.024916240945458412
################### EVAL ######################
Eval loss:84.48294067382812
epoch: 1, iter: 1100, loss:0.01405575405806303
################### EVAL ######################
Eval loss:80.48492431640625
epoch: 1, iter: 1200, loss:0.011403477750718594
################### EVAL ######################
Eval loss:87.68821716308594
epoch: 1, iter: 1300, loss:0.017150966450572014
################### EVAL ######################
Eval loss:66.1996841430664
epoch: 1, iter: 1400, loss:0.015021353028714657
################### EVAL ######################
Eval loss:84.19041442871094
epoch: 1, iter: 1500, loss:0.004568998236209154
################### EVAL ######################
Eval loss:92.07823944091797
epoch: 1, iter: 1600, loss:0.014461725950241089
################### EVAL ######################
Eval loss:93.56133270263672
epoch: 2, iter: 1700, loss:0.015011753886938095
################### EVAL ######################
Eval loss:92.95323944091797
epoch: 2, iter: 1800, loss:0.00771954795345664
################### EVAL ######################
Eval loss:92.51140594482422
epoch: 2, iter: 1900, loss:0.0025582988746464252
################### EVAL ######################
Eval loss:91.73673248291016
epoch: 2, iter: 2000, loss:0.0019364666659384966
################### EVAL ######################
Eval loss:98.14683532714844
epoch: 2, iter: 2100, loss:0.012098395265638828
################### EVAL ######################
Eval loss:103.40522003173828
epoch: 2, iter: 2200, loss:0.012604685500264168
################### EVAL ######################
Eval loss:107.8743896484375
epoch: 2, iter: 2300, loss:0.001152528217062354
################### EVAL ######################
Eval loss:112.591552734375
epoch: 2, iter: 2400, loss:0.01915513537824154
################### EVAL ######################
Eval loss:115.3091049194336
epoch: 3, iter: 2500, loss:0.001041632378473878
################### EVAL ######################
Eval loss:117.1603775024414
epoch: 3, iter: 2600, loss:0.01402310747653246
################### EVAL ######################
Eval loss:107.25849151611328
epoch: 3, iter: 2700, loss:0.011362102814018726
################### EVAL ######################
Eval loss:107.69854736328125
epoch: 3, iter: 2800, loss:0.004759908188134432
################### EVAL ######################
Eval loss:110.95500946044922
epoch: 3, iter: 2900, loss:0.009974858723580837
################### EVAL ######################
Eval loss:118.29612731933594
epoch: 3, iter: 3000, loss:0.01360607985407114
################### EVAL ######################
Eval loss:102.47158813476562
epoch: 3, iter: 3100, loss:0.003871005494147539
################### EVAL ######################
Eval loss:112.53286743164062
epoch: 3, iter: 3200, loss:0.006429343484342098
################### EVAL ######################
Eval loss:116.09029388427734
epoch: 4, iter: 3300, loss:0.012192124500870705
################### EVAL ######################
Eval loss:119.06980895996094
epoch: 4, iter: 3400, loss:0.0009946449426934123
################### EVAL ######################
Eval loss:123.52362823486328
epoch: 4, iter: 3500, loss:0.004643064923584461
################### EVAL ######################
Eval loss:126.71249389648438
epoch: 4, iter: 3600, loss:0.005763843655586243
################### EVAL ######################
Eval loss:126.89681243896484
epoch: 4, iter: 3700, loss:0.002426438732072711
################### EVAL ######################
Eval loss:128.4833526611328
epoch: 4, iter: 3800, loss:0.012658222578465939
################### EVAL ######################
Eval loss:134.1611785888672
epoch: 4, iter: 3900, loss:0.0028190945740789175
################### EVAL ######################
Eval loss:135.47499084472656
epoch: 4, iter: 4000, loss:0.004119966644793749
################### EVAL ######################
Eval loss:141.29371643066406
epoch: 5, iter: 4100, loss:0.0034855445846915245
################### EVAL ######################
Eval loss:130.04637145996094
epoch: 5, iter: 4200, loss:0.00211003003641963
################### EVAL ######################
Eval loss:134.9724578857422
epoch: 5, iter: 4300, loss:0.007040067110210657
################### EVAL ######################
Eval loss:143.4202423095703
epoch: 5, iter: 4400, loss:0.0041623967699706554
################### EVAL ######################
Eval loss:132.5865020751953
epoch: 5, iter: 4500, loss:0.0058704642578959465
################### EVAL ######################
Eval loss:140.13800048828125
epoch: 5, iter: 4600, loss:0.0011208107462152839
################### EVAL ######################
Eval loss:137.1458740234375
epoch: 5, iter: 4700, loss:0.006663849111646414
################### EVAL ######################
Eval loss:138.95388793945312
epoch: 5, iter: 4800, loss:0.006210690829902887
################### EVAL ######################
Eval loss:140.5439910888672
epoch: 5, iter: 4900, loss:0.0020649696234613657
################### EVAL ######################
Eval loss:71.84344482421875
epoch: 6, iter: 5000, loss:0.001962522976100445
################### EVAL ######################
Eval loss:97.5789794921875
epoch: 6, iter: 5100, loss:0.0017066984437406063
################### EVAL ######################
Eval loss:111.57160186767578
epoch: 6, iter: 5200, loss:0.0004948197165504098
################### EVAL ######################
Eval loss:128.21923828125
epoch: 6, iter: 5300, loss:0.0074038393795490265
################### EVAL ######################
Eval loss:105.28419494628906
epoch: 6, iter: 5400, loss:0.0029288644436746836
################### EVAL ######################
Eval loss:118.23088836669922
epoch: 6, iter: 5500, loss:0.005505172535777092
################### EVAL ######################
Eval loss:128.40927124023438
epoch: 6, iter: 5600, loss:0.0046905712224543095
################### EVAL ######################
Eval loss:137.0938720703125
epoch: 6, iter: 5700, loss:0.006609996780753136
################### EVAL ######################
Eval loss:139.5074005126953
epoch: 7, iter: 5800, loss:0.0014861434465274215
################### EVAL ######################
Eval loss:158.53175354003906
epoch: 7, iter: 5900, loss:0.0021819870453327894
################### EVAL ######################
Eval loss:159.39694213867188
epoch: 7, iter: 6000, loss:0.0015236327890306711
################### EVAL ######################
Eval loss:128.12767028808594
epoch: 7, iter: 6100, loss:0.002680906094610691
################### EVAL ######################
Eval loss:138.349609375
epoch: 7, iter: 6200, loss:0.0013839352177456021
################### EVAL ######################
Eval loss:143.93585205078125
epoch: 7, iter: 6300, loss:0.010363224893808365
################### EVAL ######################
Eval loss:139.83908081054688
epoch: 7, iter: 6400, loss:0.0003008581988979131
################### EVAL ######################
Eval loss:164.03443908691406
epoch: 7, iter: 6500, loss:0.0013829105300828815
################### EVAL ######################
Eval loss:161.4720458984375
epoch: 8, iter: 6600, loss:0.00011934206122532487
################### EVAL ######################
Eval loss:169.5876007080078
epoch: 8, iter: 6700, loss:0.007241180166602135
################### EVAL ######################
Eval loss:164.24180603027344
epoch: 8, iter: 6800, loss:0.000943883613217622
################### EVAL ######################
Eval loss:157.9765625
epoch: 8, iter: 6900, loss:0.0006389753543771803
################### EVAL ######################
Eval loss:180.2418212890625
epoch: 8, iter: 7000, loss:0.000842982204630971
################### EVAL ######################
Eval loss:181.4632110595703
epoch: 8, iter: 7100, loss:0.0002524701994843781
################### EVAL ######################
Eval loss:173.1294403076172
epoch: 8, iter: 7200, loss:0.0009082076721824706
################### EVAL ######################
Eval loss:172.62088012695312
epoch: 8, iter: 7300, loss:0.0010515491012483835
################### EVAL ######################
Eval loss:167.22300720214844
epoch: 9, iter: 7400, loss:0.0047874171286821365
################### EVAL ######################
Eval loss:162.87677001953125
epoch: 9, iter: 7500, loss:0.007600361946970224
################### EVAL ######################
Eval loss:191.02183532714844
epoch: 9, iter: 7600, loss:0.007979176938533783
################### EVAL ######################
Eval loss:195.4373321533203
epoch: 9, iter: 7700, loss:0.0016828542575240135
################### EVAL ######################
Eval loss:177.02488708496094
epoch: 9, iter: 7800, loss:0.002428384032100439
################### EVAL ######################
Eval loss:162.2318878173828
epoch: 9, iter: 7900, loss:0.00042337647755630314
################### EVAL ######################
Eval loss:167.40858459472656
epoch: 9, iter: 8000, loss:0.0007400227477774024
################### EVAL ######################
Eval loss:190.4800567626953
epoch: 9, iter: 8100, loss:0.006794978864490986
################### EVAL ######################
Eval loss:208.97666931152344
############################## Training End. ##############################
################### TEST ######################
Recall 0.1418-0.3106
NDCG 0.1227-0.1840
