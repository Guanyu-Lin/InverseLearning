arguments: Namespace(batch_size=1024, dataset='adressa', drop_rate=0.0, dropout=0.0, epochs=10, eval_freq=100, exponent=1, factor_num=32, gpu='6', lr=0.001, model='NeuMF-end', num_gradual=0, num_layers=3, num_ng=1, out=True, top_k=[3, 20]) 
config model NeuMF-end
config data path ../data/adressa/
config model path ./models/adressa/
user, item num
212231 6596
data loaded! user_num:212231, item_num:6596 train_data_len:419491 test_user_num:10380
/storage/wjwang/anaconda3/lib/python3.7/site-packages/torch/nn/_reduction.py:43: UserWarning: size_average and reduce args will be deprecated, please use reduction='none' instead.
  warnings.warn(warning.format(ret))
epoch: 0, iter: 100, loss:0.10996286571025848
################### EVAL ######################
Eval loss:40.384952545166016
epoch: 0, iter: 200, loss:0.10951213538646698
################### EVAL ######################
Eval loss:41.79056930541992
epoch: 0, iter: 300, loss:0.09114918112754822
################### EVAL ######################
Eval loss:42.146095275878906
epoch: 0, iter: 400, loss:0.1432606726884842
################### EVAL ######################
Eval loss:43.57331848144531
epoch: 0, iter: 500, loss:0.11643729358911514
################### EVAL ######################
Eval loss:42.8974609375
epoch: 0, iter: 600, loss:0.11694397032260895
################### EVAL ######################
Eval loss:42.937705993652344
epoch: 0, iter: 700, loss:0.07490001618862152
################### EVAL ######################
Eval loss:40.731964111328125
epoch: 0, iter: 800, loss:0.1071864515542984
################### EVAL ######################
Eval loss:42.288639068603516
epoch: 1, iter: 900, loss:0.08132388442754745
################### EVAL ######################
Eval loss:56.28801345825195
epoch: 1, iter: 1000, loss:0.08017483353614807
################### EVAL ######################
Eval loss:54.668704986572266
epoch: 1, iter: 1100, loss:0.09601949155330658
################### EVAL ######################
Eval loss:60.77448654174805
epoch: 1, iter: 1200, loss:0.07092157006263733
################### EVAL ######################
Eval loss:62.07597351074219
epoch: 1, iter: 1300, loss:0.07639388740062714
################### EVAL ######################
Eval loss:59.349727630615234
epoch: 1, iter: 1400, loss:0.0886385440826416
################### EVAL ######################
Eval loss:62.947391510009766
epoch: 1, iter: 1500, loss:0.08051487803459167
################### EVAL ######################
Eval loss:64.69029998779297
epoch: 1, iter: 1600, loss:0.08056820929050446
################### EVAL ######################
Eval loss:65.27377319335938
epoch: 2, iter: 1700, loss:0.05097263306379318
################### EVAL ######################
Eval loss:77.72401428222656
epoch: 2, iter: 1800, loss:0.05456504598259926
################### EVAL ######################
Eval loss:84.00260925292969
epoch: 2, iter: 1900, loss:0.05375887453556061
################### EVAL ######################
Eval loss:81.9666519165039
epoch: 2, iter: 2000, loss:0.051555998623371124
################### EVAL ######################
Eval loss:82.51091003417969
epoch: 2, iter: 2100, loss:0.062119558453559875
################### EVAL ######################
Eval loss:81.40786743164062
epoch: 2, iter: 2200, loss:0.056497178971767426
################### EVAL ######################
Eval loss:81.65035247802734
epoch: 2, iter: 2300, loss:0.05388971418142319
################### EVAL ######################
Eval loss:84.9825210571289
epoch: 2, iter: 2400, loss:0.06167815253138542
################### EVAL ######################
Eval loss:86.90941619873047
epoch: 3, iter: 2500, loss:0.03396651893854141
################### EVAL ######################
Eval loss:127.68136596679688
epoch: 3, iter: 2600, loss:0.036503493785858154
################### EVAL ######################
Eval loss:123.08657836914062
epoch: 3, iter: 2700, loss:0.03525690734386444
################### EVAL ######################
Eval loss:125.27538299560547
epoch: 3, iter: 2800, loss:0.03813830018043518
################### EVAL ######################
Eval loss:117.24168395996094
epoch: 3, iter: 2900, loss:0.024419821798801422
################### EVAL ######################
Eval loss:118.61490631103516
epoch: 3, iter: 3000, loss:0.037806436419487
################### EVAL ######################
Eval loss:115.25152587890625
epoch: 3, iter: 3100, loss:0.04203566908836365
################### EVAL ######################
Eval loss:123.0020523071289
epoch: 3, iter: 3200, loss:0.03551078960299492
################### EVAL ######################
Eval loss:128.3376922607422
epoch: 4, iter: 3300, loss:0.021415770053863525
################### EVAL ######################
Eval loss:150.37074279785156
epoch: 4, iter: 3400, loss:0.01835644245147705
################### EVAL ######################
Eval loss:165.6073455810547
epoch: 4, iter: 3500, loss:0.022127386182546616
################### EVAL ######################
Eval loss:189.52066040039062
epoch: 4, iter: 3600, loss:0.023771878331899643
################### EVAL ######################
Eval loss:175.61184692382812
epoch: 4, iter: 3700, loss:0.024370942264795303
################### EVAL ######################
Eval loss:173.6910400390625
epoch: 4, iter: 3800, loss:0.03026772476732731
################### EVAL ######################
Eval loss:156.23558044433594
epoch: 4, iter: 3900, loss:0.01637578010559082
################### EVAL ######################
Eval loss:159.78073120117188
epoch: 4, iter: 4000, loss:0.02619989402592182
################### EVAL ######################
Eval loss:170.67269897460938
epoch: 5, iter: 4100, loss:0.018228407949209213
################### EVAL ######################
Eval loss:189.0302276611328
epoch: 5, iter: 4200, loss:0.011361737735569477
################### EVAL ######################
Eval loss:225.11326599121094
epoch: 5, iter: 4300, loss:0.022057127207517624
################### EVAL ######################
Eval loss:228.4414520263672
epoch: 5, iter: 4400, loss:0.019730450585484505
################### EVAL ######################
Eval loss:225.63348388671875
epoch: 5, iter: 4500, loss:0.021334823220968246
################### EVAL ######################
Eval loss:240.01473999023438
epoch: 5, iter: 4600, loss:0.009541898965835571
################### EVAL ######################
Eval loss:225.3446044921875
epoch: 5, iter: 4700, loss:0.010253114625811577
################### EVAL ######################
Eval loss:234.15274047851562
epoch: 5, iter: 4800, loss:0.021833037957549095
################### EVAL ######################
Eval loss:242.35867309570312
epoch: 5, iter: 4900, loss:0.007148677483201027
################### EVAL ######################
Eval loss:212.4091796875
epoch: 6, iter: 5000, loss:0.012551594525575638
################### EVAL ######################
Eval loss:258.09991455078125
epoch: 6, iter: 5100, loss:0.013606848195195198
################### EVAL ######################
Eval loss:256.5406799316406
epoch: 6, iter: 5200, loss:0.007050834596157074
################### EVAL ######################
Eval loss:246.15283203125
epoch: 6, iter: 5300, loss:0.026064591482281685
################### EVAL ######################
Eval loss:291.65252685546875
epoch: 6, iter: 5400, loss:0.008479638025164604
################### EVAL ######################
Eval loss:275.7058410644531
epoch: 6, iter: 5500, loss:0.01487167738378048
################### EVAL ######################
Eval loss:297.2671203613281
epoch: 6, iter: 5600, loss:0.00867034774273634
################### EVAL ######################
Eval loss:269.677734375
epoch: 6, iter: 5700, loss:0.008010830730199814
################### EVAL ######################
Eval loss:243.5496368408203
epoch: 7, iter: 5800, loss:0.014151392504572868
################### EVAL ######################
Eval loss:307.9707946777344
epoch: 7, iter: 5900, loss:0.005143099930137396
################### EVAL ######################
Eval loss:288.1202087402344
epoch: 7, iter: 6000, loss:0.0070573496632277966
################### EVAL ######################
Eval loss:292.29058837890625
epoch: 7, iter: 6100, loss:0.0051469700410962105
################### EVAL ######################
Eval loss:317.0203552246094
epoch: 7, iter: 6200, loss:0.004221150651574135
################### EVAL ######################
Eval loss:275.1307678222656
epoch: 7, iter: 6300, loss:0.014894118532538414
################### EVAL ######################
Eval loss:298.1282043457031
epoch: 7, iter: 6400, loss:0.013457108289003372
################### EVAL ######################
Eval loss:283.85272216796875
epoch: 7, iter: 6500, loss:0.013522624969482422
################### EVAL ######################
Eval loss:313.2586669921875
epoch: 8, iter: 6600, loss:0.005455665290355682
################### EVAL ######################
Eval loss:341.5845642089844
epoch: 8, iter: 6700, loss:0.006703553721308708
################### EVAL ######################
Eval loss:346.00445556640625
epoch: 8, iter: 6800, loss:0.004063830245286226
################### EVAL ######################
Eval loss:367.92138671875
epoch: 8, iter: 6900, loss:0.007250223308801651
################### EVAL ######################
Eval loss:358.3414001464844
epoch: 8, iter: 7000, loss:0.002907341346144676
################### EVAL ######################
Eval loss:345.95379638671875
epoch: 8, iter: 7100, loss:0.005494558252394199
################### EVAL ######################
Eval loss:348.1840515136719
epoch: 8, iter: 7200, loss:0.004061211831867695
################### EVAL ######################
Eval loss:343.1741027832031
epoch: 8, iter: 7300, loss:0.0034110511187464
################### EVAL ######################
Eval loss:347.44866943359375
epoch: 9, iter: 7400, loss:0.004739090800285339
################### EVAL ######################
Eval loss:365.4188537597656
epoch: 9, iter: 7500, loss:0.011044454760849476
################### EVAL ######################
Eval loss:395.27471923828125
epoch: 9, iter: 7600, loss:0.01929125376045704
################### EVAL ######################
Eval loss:363.4249267578125
epoch: 9, iter: 7700, loss:0.004002068191766739
################### EVAL ######################
Eval loss:381.4981384277344
epoch: 9, iter: 7800, loss:0.0055395751260221004
################### EVAL ######################
Eval loss:376.2098693847656
epoch: 9, iter: 7900, loss:0.005142773501574993
################### EVAL ######################
Eval loss:376.15240478515625
epoch: 9, iter: 8000, loss:0.0022383946925401688
################### EVAL ######################
Eval loss:352.5012512207031
epoch: 9, iter: 8100, loss:0.00891100987792015
################### EVAL ######################
Eval loss:389.20318603515625
############################## Training End. ##############################
################### TEST ######################
Recall 0.1416-0.3159
NDCG 0.1267-0.1886
