arguments: Namespace(batch_size=1024, dataset='amazon_book', drop_rate=0.2, dropout=0.0, epochs=10, eval_freq=2000, exponent=1, factor_num=32, gpu='6', lr=0.001, model='NeuMF-end', num_gradual=30000, num_layers=3, num_ng=1, out=True, top_k=[50, 100]) 
config model NeuMF-end
config data path ../data/amazon_book/
config model path ./models/amazon_book/
user, item num
80464 98663
data loaded! user_num:80464, item_num:98663 train_data_len:2714021 test_user_num:80349
/storage/wjwang/anaconda3/lib/python3.7/site-packages/torch/nn/_reduction.py:43: UserWarning: size_average and reduce args will be deprecated, please use reduction='none' instead.
  warnings.warn(warning.format(ret))
epoch: 0, iter: 2000, loss:0.5737483501434326
################### EVAL ######################
Eval loss:385.51776123046875
epoch: 0, iter: 4000, loss:0.4617973566055298
################### EVAL ######################
Eval loss:306.8055114746094
epoch: 1, iter: 6000, loss:0.2906455099582672
################### EVAL ######################
Eval loss:244.65269470214844
epoch: 1, iter: 8000, loss:0.26405879855155945
################### EVAL ######################
Eval loss:199.34352111816406
epoch: 1, iter: 10000, loss:0.1822410374879837
################### EVAL ######################
Eval loss:168.99456787109375
epoch: 2, iter: 12000, loss:0.13795781135559082
################### EVAL ######################
Eval loss:158.1686248779297
epoch: 2, iter: 14000, loss:0.14566369354724884
################### EVAL ######################
Eval loss:140.72390747070312
epoch: 3, iter: 16000, loss:0.1397848278284073
################### EVAL ######################
Eval loss:143.70863342285156
epoch: 3, iter: 18000, loss:0.10592567920684814
################### EVAL ######################
Eval loss:129.45187377929688
epoch: 3, iter: 20000, loss:0.08343378454446793
################### EVAL ######################
Eval loss:120.57595825195312
epoch: 4, iter: 22000, loss:0.07420148700475693
################### EVAL ######################
Eval loss:131.20127868652344
epoch: 4, iter: 24000, loss:0.049872953444719315
################### EVAL ######################
Eval loss:128.37030029296875
epoch: 4, iter: 26000, loss:0.0689205750823021
################### EVAL ######################
Eval loss:100.19132995605469
epoch: 5, iter: 28000, loss:0.047062646597623825
################### EVAL ######################
Eval loss:128.0802764892578
epoch: 5, iter: 30000, loss:0.05138160660862923
################### EVAL ######################
Eval loss:111.66139221191406
epoch: 6, iter: 32000, loss:0.05456310138106346
################### EVAL ######################
Eval loss:133.26934814453125
epoch: 6, iter: 34000, loss:0.04076167196035385
################### EVAL ######################
Eval loss:118.48777770996094
epoch: 6, iter: 36000, loss:0.06476963311433792
################### EVAL ######################
Eval loss:94.65678405761719
epoch: 7, iter: 38000, loss:0.034488726407289505
################### EVAL ######################
Eval loss:150.69497680664062
epoch: 7, iter: 40000, loss:0.02001013420522213
################### EVAL ######################
Eval loss:153.26119995117188
epoch: 7, iter: 42000, loss:0.06932540982961655
################### EVAL ######################
Eval loss:133.0363311767578
epoch: 8, iter: 44000, loss:0.05080945044755936
################### EVAL ######################
Eval loss:135.0773468017578
epoch: 8, iter: 46000, loss:0.04376174136996269
################### EVAL ######################
Eval loss:160.64071655273438
epoch: 9, iter: 48000, loss:0.03042588010430336
################### EVAL ######################
Eval loss:178.73606872558594
epoch: 9, iter: 50000, loss:0.03712020069360733
################### EVAL ######################
Eval loss:154.05284118652344
epoch: 9, iter: 52000, loss:0.03620734065771103
################### EVAL ######################
Eval loss:186.74594116210938
############################## Training End. ##############################
################### TEST ######################
Recall 0.0725-0.1158
NDCG 0.0289-0.0385
