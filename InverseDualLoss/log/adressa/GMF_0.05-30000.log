arguments: Namespace(batch_size=1024, dataset='adressa', drop_rate=0.05, dropout=0.0, epochs=10, eval_freq=100, exponent=1, factor_num=32, gpu='7', lr=0.001, model='GMF', num_gradual=30000, num_layers=3, num_ng=1, out=True, top_k=[3, 20]) 
config model GMF
config data path ../data/adressa/
config model path ./models/adressa/
user, item num
212231 6596
data loaded! user_num:212231, item_num:6596 train_data_len:419491 test_user_num:10380
/storage/wjwang/anaconda3/lib/python3.7/site-packages/torch/nn/_reduction.py:43: UserWarning: size_average and reduce args will be deprecated, please use reduction='none' instead.
  warnings.warn(warning.format(ret))
epoch: 0, iter: 100, loss:0.6931416392326355
################### EVAL ######################
Eval loss:72.78026580810547
epoch: 0, iter: 200, loss:0.6929157376289368
################### EVAL ######################
Eval loss:72.76779174804688
epoch: 0, iter: 300, loss:0.6863437294960022
################### EVAL ######################
Eval loss:72.5579833984375
epoch: 0, iter: 400, loss:0.6543033123016357
################### EVAL ######################
Eval loss:71.55921173095703
epoch: 0, iter: 500, loss:0.5825610756874084
################### EVAL ######################
Eval loss:69.29762268066406
epoch: 0, iter: 600, loss:0.4989017844200134
################### EVAL ######################
Eval loss:66.45960998535156
epoch: 0, iter: 700, loss:0.41093942523002625
################### EVAL ######################
Eval loss:64.10694885253906
epoch: 0, iter: 800, loss:0.33808329701423645
################### EVAL ######################
Eval loss:62.856727600097656
epoch: 1, iter: 900, loss:0.24670588970184326
################### EVAL ######################
Eval loss:62.84686279296875
epoch: 1, iter: 1000, loss:0.20189954340457916
################### EVAL ######################
Eval loss:63.023353576660156
epoch: 1, iter: 1100, loss:0.1834557205438614
################### EVAL ######################
Eval loss:63.76707077026367
epoch: 1, iter: 1200, loss:0.16499631106853485
################### EVAL ######################
Eval loss:64.24845123291016
epoch: 1, iter: 1300, loss:0.13783057034015656
################### EVAL ######################
Eval loss:65.46073913574219
epoch: 1, iter: 1400, loss:0.15621818602085114
################### EVAL ######################
Eval loss:66.45964050292969
epoch: 1, iter: 1500, loss:0.11974357813596725
################### EVAL ######################
Eval loss:67.57685089111328
epoch: 1, iter: 1600, loss:0.11989771574735641
################### EVAL ######################
Eval loss:68.7120132446289
epoch: 2, iter: 1700, loss:0.10138708353042603
################### EVAL ######################
Eval loss:70.23350524902344
epoch: 2, iter: 1800, loss:0.08158338069915771
################### EVAL ######################
Eval loss:71.14767456054688
epoch: 2, iter: 1900, loss:0.1055552288889885
################### EVAL ######################
Eval loss:72.60631561279297
epoch: 2, iter: 2000, loss:0.10567226260900497
################### EVAL ######################
Eval loss:73.79867553710938
epoch: 2, iter: 2100, loss:0.0759049579501152
################### EVAL ######################
Eval loss:75.06356811523438
epoch: 2, iter: 2200, loss:0.0737723559141159
################### EVAL ######################
Eval loss:75.98702239990234
epoch: 2, iter: 2300, loss:0.12347368150949478
################### EVAL ######################
Eval loss:76.94415283203125
epoch: 2, iter: 2400, loss:0.06955495476722717
################### EVAL ######################
Eval loss:76.86968994140625
epoch: 3, iter: 2500, loss:0.08075948059558868
################### EVAL ######################
Eval loss:77.962890625
epoch: 3, iter: 2600, loss:0.07374599575996399
################### EVAL ######################
Eval loss:78.9615707397461
epoch: 3, iter: 2700, loss:0.05665646120905876
################### EVAL ######################
Eval loss:79.62741088867188
epoch: 3, iter: 2800, loss:0.07162436842918396
################### EVAL ######################
Eval loss:79.95124053955078
epoch: 3, iter: 2900, loss:0.0882822647690773
################### EVAL ######################
Eval loss:80.6597671508789
epoch: 3, iter: 3000, loss:0.08072967827320099
################### EVAL ######################
Eval loss:80.8770751953125
epoch: 3, iter: 3100, loss:0.06544497609138489
################### EVAL ######################
Eval loss:82.1628646850586
epoch: 3, iter: 3200, loss:0.09268225729465485
################### EVAL ######################
Eval loss:81.89214324951172
epoch: 4, iter: 3300, loss:0.06552670896053314
################### EVAL ######################
Eval loss:82.40904235839844
epoch: 4, iter: 3400, loss:0.05680610612034798
################### EVAL ######################
Eval loss:83.8122787475586
epoch: 4, iter: 3500, loss:0.06610353291034698
################### EVAL ######################
Eval loss:84.4293212890625
epoch: 4, iter: 3600, loss:0.0662861168384552
################### EVAL ######################
Eval loss:84.07074737548828
epoch: 4, iter: 3700, loss:0.06653662025928497
################### EVAL ######################
Eval loss:84.9198989868164
epoch: 4, iter: 3800, loss:0.0932503491640091
################### EVAL ######################
Eval loss:86.02314758300781
epoch: 4, iter: 3900, loss:0.0827256441116333
################### EVAL ######################
Eval loss:85.68729400634766
epoch: 4, iter: 4000, loss:0.05771079286932945
################### EVAL ######################
Eval loss:86.43756866455078
epoch: 5, iter: 4100, loss:0.07007931917905807
################### EVAL ######################
Eval loss:86.39232635498047
epoch: 5, iter: 4200, loss:0.08064451813697815
################### EVAL ######################
Eval loss:86.99535369873047
epoch: 5, iter: 4300, loss:0.06765087693929672
################### EVAL ######################
Eval loss:88.60891723632812
epoch: 5, iter: 4400, loss:0.05882352590560913
################### EVAL ######################
Eval loss:89.700927734375
epoch: 5, iter: 4500, loss:0.04489906504750252
################### EVAL ######################
Eval loss:90.12765502929688
epoch: 5, iter: 4600, loss:0.06485615670681
################### EVAL ######################
Eval loss:90.46280670166016
epoch: 5, iter: 4700, loss:0.06948589533567429
################### EVAL ######################
Eval loss:90.13095092773438
epoch: 5, iter: 4800, loss:0.060478344559669495
################### EVAL ######################
Eval loss:90.80780029296875
epoch: 5, iter: 4900, loss:0.049474675208330154
################### EVAL ######################
Eval loss:91.59282684326172
epoch: 6, iter: 5000, loss:0.06225048750638962
################### EVAL ######################
Eval loss:93.24040985107422
epoch: 6, iter: 5100, loss:0.04555276036262512
################### EVAL ######################
Eval loss:93.76820373535156
epoch: 6, iter: 5200, loss:0.08769212663173676
################### EVAL ######################
Eval loss:94.5827407836914
epoch: 6, iter: 5300, loss:0.05179829150438309
################### EVAL ######################
Eval loss:94.16681671142578
epoch: 6, iter: 5400, loss:0.05184606462717056
################### EVAL ######################
Eval loss:95.32725524902344
epoch: 6, iter: 5500, loss:0.07405506074428558
################### EVAL ######################
Eval loss:96.00933074951172
epoch: 6, iter: 5600, loss:0.048829104751348495
################### EVAL ######################
Eval loss:96.08064270019531
epoch: 6, iter: 5700, loss:0.047946833074092865
################### EVAL ######################
Eval loss:97.18505096435547
epoch: 7, iter: 5800, loss:0.04658376798033714
################### EVAL ######################
Eval loss:97.78273010253906
epoch: 7, iter: 5900, loss:0.07262784242630005
################### EVAL ######################
Eval loss:98.54327392578125
epoch: 7, iter: 6000, loss:0.06218476966023445
################### EVAL ######################
Eval loss:99.25227355957031
epoch: 7, iter: 6100, loss:0.05769212171435356
################### EVAL ######################
Eval loss:100.17927551269531
epoch: 7, iter: 6200, loss:0.07897612452507019
################### EVAL ######################
Eval loss:100.66558837890625
epoch: 7, iter: 6300, loss:0.055655814707279205
################### EVAL ######################
Eval loss:101.42723846435547
epoch: 7, iter: 6400, loss:0.0583825558423996
################### EVAL ######################
Eval loss:101.90013122558594
epoch: 7, iter: 6500, loss:0.04861588403582573
################### EVAL ######################
Eval loss:101.36895751953125
epoch: 8, iter: 6600, loss:0.04909345135092735
################### EVAL ######################
Eval loss:101.88674926757812
epoch: 8, iter: 6700, loss:0.041400328278541565
################### EVAL ######################
Eval loss:104.16372680664062
epoch: 8, iter: 6800, loss:0.05570272356271744
################### EVAL ######################
Eval loss:105.22673034667969
epoch: 8, iter: 6900, loss:0.03263111039996147
################### EVAL ######################
Eval loss:105.33780670166016
epoch: 8, iter: 7000, loss:0.043092992156744
################### EVAL ######################
Eval loss:105.83067321777344
epoch: 8, iter: 7100, loss:0.038129258900880814
################### EVAL ######################
Eval loss:105.7953109741211
epoch: 8, iter: 7200, loss:0.04995577782392502
################### EVAL ######################
Eval loss:106.27842712402344
epoch: 8, iter: 7300, loss:0.04116859659552574
################### EVAL ######################
Eval loss:106.85719299316406
epoch: 9, iter: 7400, loss:0.03394467756152153
################### EVAL ######################
Eval loss:106.85572052001953
epoch: 9, iter: 7500, loss:0.05415192246437073
################### EVAL ######################
Eval loss:108.6015396118164
epoch: 9, iter: 7600, loss:0.032894279807806015
################### EVAL ######################
Eval loss:109.5024185180664
epoch: 9, iter: 7700, loss:0.03575947880744934
################### EVAL ######################
Eval loss:109.5146484375
epoch: 9, iter: 7800, loss:0.03070811741054058
################### EVAL ######################
Eval loss:110.5468978881836
epoch: 9, iter: 7900, loss:0.04329705610871315
################### EVAL ######################
Eval loss:110.28076934814453
epoch: 9, iter: 8000, loss:0.049022093415260315
################### EVAL ######################
Eval loss:111.80469512939453
epoch: 9, iter: 8100, loss:0.05015496537089348
################### EVAL ######################
Eval loss:111.539794921875
############################## Training End. ##############################
################### TEST ######################
Recall 0.0892-0.2170
NDCG 0.0790-0.1254
